import os
from dotenv import load_dotenv
import groq

# .env íŒŒì¼ ë¡œë“œ
load_dotenv(dotenv_path="groq.env")

# Groq API í‚¤ ì„¤ì •
api_key = os.getenv("GROQ_API_KEY")

if not api_key:
    raise ValueError("Groq API Keyê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.")

# Groq í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™”
client = groq.Client(api_key=api_key)

def generate_resume(job_description, user_story, company_info = ""):
    """
    Groq APIë¥¼ í˜¸ì¶œí•˜ì—¬ ìê¸°ì†Œê°œì„œë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜
    """
    prompt = f"""
    ì±„ìš© ê³µê³  ì„¤ëª…: {job_description}
    ì‚¬ìš©ìì˜ ì´ì•¼ê¸°: {user_story}
    íšŒì‚¬ ì •ë³´: {company_info}

    ì´ íšŒì‚¬ëŠ” intelë¡œ ë‹¤ìŒê³¼ ê°™ì€ ì¸ì¬ë¥¼ ì°¾ì•„.

    1. ì¸í…”ì˜ ì¸ì¬ìƒ
    ì¸í…”ì€ "ì§€ëŠ¥ì ì´ê³  ì—´ì •ì ì¸ ì¸ì¬"ë¥¼ ì¤‘ì‹œí•©ë‹ˆë‹¤. íŠ¹íˆ ë‹¤ìŒ íŠ¹ì„±ì„ ê°€ì§„ ì‚¬ëŒì„ ì„ í˜¸í•©ë‹ˆë‹¤:

    ì°½ì˜ì„± : ë¬¸ì œë¥¼ ìƒˆë¡­ê³  í˜ì‹ ì ì¸ ë°©ì‹ìœ¼ë¡œ í•´ê²°í•  ìˆ˜ ìˆëŠ” ëŠ¥ë ¥.
    ì ì‘ë ¥ : ë¹ ë¥´ê²Œ ë³€í™”í•˜ëŠ” ê¸°ìˆ  í™˜ê²½ì—ì„œ ìœ ì—°í•˜ê²Œ ëŒ€ì²˜í•  ìˆ˜ ìˆëŠ” íƒœë„ .
    í˜‘ì—… ì—­ëŸ‰ : ë‹¤ì–‘í•œ ë°°ê²½ê³¼ ì „ë¬¸ì„±ì„ ê°€ì§„ ì‚¬ëŒë“¤ê³¼ íŒ€ì›Œí¬ë¥¼ ë°œíœ˜í•  ìˆ˜ ìˆëŠ” ëŠ¥ë ¥ .
    ë˜í•œ, ì¸í…”ì€ í¬ìš©ì ì¸ ì¡°ì§ ë¬¸í™”ë¥¼ ì§€í–¥í•˜ë©°, ëª¨ë“  ì§ì›ì´ ì˜ë¯¸ ìˆëŠ” ì¼ì— ëª°ì…í•  ìˆ˜ ìˆë„ë¡ ì§€ì›í•©ë‹ˆë‹¤ .

    2. ì¸í…”ì˜ ë¹„ì „
    ì¸í…”ì˜ ê¶ê·¹ì ì¸ ë¹„ì „ì€ "ì„¸ìƒì„ ë³€í™”ì‹œí‚¤ëŠ” ê¸°ìˆ ì„ ê°œë°œí•´ ì „ ì¸ë¥˜ì˜ ì‚¶ì„ ê°œì„ í•˜ëŠ” ê²ƒ"ì…ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì€ ëª©í‘œë¥¼ ì¶”êµ¬í•©ë‹ˆë‹¤:

    í´ë¼ìš°ë“œ ì»´í“¨íŒ… ë° ë°ì´í„°ì„¼í„° íš¨ìœ¨ì„± í–¥ìƒ: IT ìì›ì˜ í™œìš©ë„ë¥¼ ë†’ì´ê³  ìœ ì—°ì„±ì„ ì œê³µí•˜ì—¬ ê¸°ìˆ ì  ë³‘ëª© í˜„ìƒì„ í•´ê²°í•˜ë ¤ í•©ë‹ˆë‹¤ .
    ë°˜ë„ì²´ ê¸°ìˆ  í˜ì‹ : ìµœì‹  CPU ì•„í‚¤í…ì²˜ ë° ì•ˆì •ì„±ì„ ê°œì„ í•˜ê¸° ìœ„í•œ ì—°êµ¬ë¥¼ ì§€ì†ì ìœ¼ë¡œ ìˆ˜í–‰í•©ë‹ˆë‹¤ .
    3. í•´ê²°í•˜ê³ ì í•˜ëŠ” ë¬¸ì œ
    ì¸í…”ì€ ë‹¤ì–‘í•œ ê¸°ìˆ ì  ë„ì „ ê³¼ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë…¸ë ¥í•˜ê³  ìˆìŠµë‹ˆë‹¤:

    CPU ì„±ëŠ¥ ë° ì•ˆì •ì„± ë¬¸ì œ : ì˜ˆë¥¼ ë“¤ì–´, 13/14ì„¸ëŒ€ ì½”ì–´ í”„ë¡œì„¸ì„œì—ì„œ ë°œìƒí•œ ì „ì•• ìƒìŠ¹ìœ¼ë¡œ ì¸í•œ ë¶ˆì•ˆì •ì„± ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë§ˆì´í¬ë¡œì½”ë“œ íŒ¨ì¹˜ë¥¼ ì œê³µí–ˆìŠµë‹ˆë‹¤ .
    ë°ì´í„° ì„¼í„° ìš”êµ¬ ì¦ê°€ : í´ë¼ìš°ë“œ ê¸°ë°˜ ì„œë¹„ìŠ¤ì˜ ê¸‰ê²©í•œ ì„±ì¥ì— ë”°ë¼ ë” íš¨ìœ¨ì ì´ê³  í™•ì¥ ê°€ëŠ¥í•œ ì†”ë£¨ì…˜ì„ ê°œë°œí•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤ .
    4. ì¸í…”ì´ ì°¾ëŠ” ì¸ì¬ ìœ í˜•
    ì¸í…”ì€ ìœ„ì™€ ê°™ì€ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆëŠ” ì¸ì¬ë¥¼ ì°¾ê¸° ìœ„í•´ íŠ¹ì • ìš”ì†Œë¥¼ í‰ê°€í•©ë‹ˆë‹¤:

    ì§ë¬´ë³„ ë§ì¶¤í˜• í‰ê°€ : ê° ì§ë¬´ë§ˆë‹¤ ìš”êµ¬ ì‚¬í•­ì´ ë‹¤ë¥´ê¸° ë•Œë¬¸ì—, ëª¨ë“  ë©´ì ‘ ì§ˆë¬¸ì— í†µê³¼í•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤. ë„¤ ëª…ìœ¼ë¡œ êµ¬ì„±ëœ ì±„ìš©íŒ€ì´ í›„ë³´ìë¥¼ ì¢…í•©ì ìœ¼ë¡œ í‰ê°€í•©ë‹ˆë‹¤ .
    ì—´ì •ê³¼ ì‹¤í–‰ë ¥ : ë‹¨ìˆœíˆ ì§€ì‹ë§Œì´ ì•„ë‹Œ, ì‹¤ì§ˆì ì¸ ì„±ê³¼ë¥¼ ë‚´ê³ ì í•˜ëŠ” ì˜ì§€ë¥¼ ê°€ì§„ ì‚¬ëŒì„ ì„ í˜¸í•©ë‹ˆë‹¤.
    ë‹¤ì–‘ì„± ì¡´ì¤‘ : ë‹¤ì–‘í•œ ë°°ê²½ê³¼ ê²½í—˜ì„ ê°€ì§„ ì‚¬ëŒë“¤ì„ í™˜ì˜í•˜ë©°, ì´ë“¤ì˜ ì‹œë„ˆì§€ë¥¼ í†µí•´ ë” í° ì„±ê³¼ë¥¼ ì°½ì¶œí•˜ë ¤ í•©ë‹ˆë‹¤ .


    ë‚´ê°€ ì§€ê¸ˆê¹Œì§€ ì „ë‹¬í•´ì¤€ ì •ë³´ë¥¼ í† ëŒ€ë¡œ
    ìœ„ì— ì˜¬ë¦° íšŒì‚¬ì˜ ì±„ìš©ê³µê³ ì— ì§€ì›í•  ìê¸°ì†Œê°œì„œë¥¼ ì¨ì¤˜
    ë‘ê´„ì‹ìœ¼ë¡œ í•´ì£¼ê³ 
    íšŒì‚¬ê°€ ë‹¹ë©´í•œ ë¬¸ì œê°€ ë¬´ì—‡ì´ê³ 
    ê·¸ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ì´ëŸ° ì±„ìš©ê³µê³ ë¥¼ ë‚¸ ê²ƒìœ¼ë¡œ ì‚¬ë£Œëœë‹¤
    ë‚´ê°€ ê°€ì§„ ê²½í—˜ê³¼ ì—­ëŸ‰ìœ¼ë¡œ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤
    ì´ëŸ° ì‹ìœ¼ë¡œ ì¨ì¤˜
    """

    try:
        # Groq API í˜¸ì¶œ
        response = client.chat.completions.create(
            model="qwen-qwq-32b",  # qwen-qwq-32b ëª¨ë¸ ì‚¬ìš©
            messages=[
                {"role": "system", "content": "ë‹¹ì‹ ì€ ìê¸°ì†Œê°œì„œ ì „ë¬¸ê°€ì…ë‹ˆë‹¤."},
                {"role": "user", "content": prompt}
            ],
            temperature=0.7,
            max_tokens=2000
        )
        
        # Groq API ì‘ë‹µ ì²˜ë¦¬
        if response and hasattr(response, 'choices') and len(response.choices) > 0:
            generated_resume = response.choices[0].message.content
            print("ğŸ’¡ Groq ì‘ë‹µ:", generated_resume)  # ë¡œê·¸ í™•ì¸
            return generated_resume
        else:
            print("Groq API ì˜¤ë¥˜:", response)
            return "Groq API ì‘ë‹µì„ ì²˜ë¦¬í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."

    except Exception as e:
        print("Groq API í˜¸ì¶œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", str(e))
        return "Groq API ì‘ë‹µì„ ìƒì„±í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."
